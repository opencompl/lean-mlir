% LaTeX template for Artifact Evaluation V20201122
%
% Prepared by Grigori Fursin with contributions from Bruce Childers,
%   Michael Heroux, Michela Taufer and other colleagues.
%
% See examples of this Artifact Appendix in
%  * SC'17 paper: https://dl.acm.org/citation.cfm?id=3126948
%  * CGO'17 paper: https://www.cl.cam.ac.uk/~sa614/papers/Software-Prefetching-CGO2017.pdf
%  * ACM ReQuEST-ASPLOS'18 paper: https://dl.acm.org/citation.cfm?doid=3229762.3229763
%
% (C)opyright 2014-2022
%
% CC BY 4.0 license
%

\documentclass{sigplanconf}

\usepackage{hyperref}
\usepackage{minted}

\usepackage[verbose]{newunicodechar}
\newunicodechar{Γ}{\ensuremath{\Gamma}}
\newunicodechar{⊢}{\ensuremath{\vdash}}
\newunicodechar{▸}{\ensuremath{\blacktriangleright}}
\newunicodechar{∅}{\ensuremath{\emptyset}}
\newunicodechar{α}{\ensuremath{\alpha}}
\newunicodechar{β}{\ensuremath{\beta}}
\newunicodechar{δ}{\ensuremath{\delta}}
\newunicodechar{Δ}{\ensuremath{\Delta}}
\newunicodechar{ϵ}{\ensuremath{\epsilon}}
\newunicodechar{τ}{\ensuremath{\tau}}
\newunicodechar{ε}{\ensuremath{\epsilon}}
\newunicodechar{σ}{\ensuremath{\sigma}}
\newunicodechar{Σ}{\ensuremath{\Sigma}}
% \newunicodechar{α}{\ensuremath{\alpha}}
\newunicodechar{∈}{\ensuremath{\in}}
\newunicodechar{∧}{\ensuremath{\land}}

\newunicodechar{₀}{\textsubscript{0}}
\newunicodechar{₁}{\textsubscript{1}}
\newunicodechar{₂}{\textsubscript{2}}
\newunicodechar{₃}{\textsubscript{3}}
\newunicodechar{ₙ}{\textsubscript{n}}
\newunicodechar{ₘ}{\textsubscript{m}}
\newunicodechar{ₕ}{\textsubscript{h}}
\newunicodechar{⊕}{\ensuremath{\oplus}}
\newunicodechar{∀}{\ensuremath{\forall}}
\newunicodechar{∃}{\ensuremath{\exists}}
\newunicodechar{∘}{\ensuremath{\circ}}
\newunicodechar{⟦}{\ensuremath{\llbracket}}
\newunicodechar{⟧}{\ensuremath{\rrbracket}}
\newunicodechar{ℕ}{\ensuremath{\mathbb{N}}}
\newunicodechar{ℤ}{\ensuremath{\mathbb{Z}}}

% \newunicodechar{⟦}{\ensuremath{\llbracket}}
% https://tex.stackexchange.com/questions/100966/defining-scalable-white-curly-brackets-and-and
% TODO FIXME: we gotta fix these parens!
\newunicodechar{⦃}{\ensuremath{\{\{}}
\newunicodechar{⦄}{\ensuremath{\}\}}}
\newunicodechar{⧸}{\ensuremath{/}}
\newunicodechar{⊑}{\ensuremath{\sqsubseteq}}

\begin{document}

\special{papersize=8.5in,11in}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% When adding this appendix to your paper, 
% please remove above part
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\appendix
\section{Artifact Appendix}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \subsection{Abstract}

% {\em Obligatory}

\subsection{Artifact check-list (meta-information)}

% {\em Obligatory. Use just a few informal keywords in all fields applicable to your artifacts
% and remove the rest. This information is needed to find appropriate reviewers and gradually 
% unify artifact meta information in Digital Libraries.}

{\small
\begin{itemize}
  \item {\bf Program: } The code repository for our framework along with the test suite.
  \item {\bf Compilation: } Python for running the plotting scripts and the Lean4 toolchain, downloaded via \texttt{elan}
  \item {\bf Run-time environment: } Any operating system that supports Docker.
  \item {\bf Hardware: } Any x86-64 machine.
  \item {\bf Output: } Key theorems of the paper will be built and shown to have no unsound axioms.
  \item {\bf How much disk space required (approximately)?: } 10GB
  \item {\bf How much time is needed to prepare workflow (approximately)?: } 1hr
  \item {\bf How much time is needed to complete experiments (approximately)?: } 1hr
  \item {\bf Publicly available?: } Yes
  \item {\bf Code licenses (if publicly available)?: } MIT
  \item {\bf Archived (provide DOI)?: } 10.5281/zenodo.11506328
\end{itemize}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Description}

\subsubsection{Hardware dependencies}

None.

\subsubsection{Software dependencies}

Docker is necessary to run our artifact. The Docker image has all dependencies needed to compile our framework with Lean4.


%COMMENT% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%COMMENT% \subsection{Installation}
%COMMENT% 
%COMMENT% {\em Obligatory}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Experiment workflow}

Access the docker image \texttt{opencompl-ssa} from
\url{https://zenodo.org/records/11506328}

\begin{minted}[fontsize=\scriptsize]{text}
$ docker load -i opencompl-ssa.tar
$ docker run -it siddudruid/opencompl-ssa
# | This clears the build cache,
# | fetches the maths library from the build cache,
# | and builds our framework.
$ cd /code/ssa && lake clean && lake exe cache get && lake build
\end{minted}

To copy files for inspection from the docker container into the host,
 keep the container running, and in another
shell instance, use the \texttt{docker cp}
command to copy files from within the container out to the host:

\begin{minted}[fontsize=\footnotesize]{text}
$ docker container ls # find   ID
$ docker cp <CONTAINERID>:<PATH/INSIDE/CONTAINER> \
            <PATH/OUTSIDE/CONTAINER>
\end{minted}
For more about \texttt{docker cp}, please see:
(\url{https://docs.docker.com/engine/reference/commandline/cp/})


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Evaluation and expected results}

On running \texttt{lake build}, the build succeeds with no errors.
By running \texttt{grep -R "guard\_msgs"}, one should see that every key theorem 
is guarded by a \texttt{guard\_msgs}, which checks that the axioms used by the theorem does \emph{not}
include \texttt{sorry}. Check the following core theorems:

\subsubsection{Core Framework Theorems}

\begin{minted}{text}
SSA/Core/Framework.lean
2408:#guard_msgs in #print axioms denote_rewritePeepholeAt
2444:#guard_msgs in #print axioms denote_rewritePeephole
\end{minted}

\subsubsection{Five Hardest Alive Examples}

\begin{minted}{text}
SSA/Projects/InstCombine/AliveHandwrittenLargeExamples.lean
54:#guard_msgs in #print axioms alive_DivRemOfSelect
219:#guard_msgs in #print axioms alive_simplifyMulDivRem805
313:#guard_msgs in #print axioms alive_simplifyMulDivRem805'
373:#guard_msgs in #print axioms alive_simplifyMulDivRem290
432:#guard_msgs in #print axioms alive_simplifyAndOrXor2515
548:#guard_msgs in #print axioms alive_simplifySelect764
\end{minted}

\subsubsection{Example Rewrites Shown in the Paper}

\begin{minted}{text}
SSA/Projects/PaperExamples/PaperExamples.lean
136:#guard_msgs in #eval eg₀val
\end{minted}

\subsubsection{Examples from FHE and Scf dialects}

\begin{minted}{text}
SSA/Projects/FullyHomomorphicEncryption/PaperExamples.lean
107:#guard_msgs in #print axioms lhs
153:#guard_msgs in #print axioms p1

SSA/Projects/Scf/ScfFunctor.lean
488:#guard_msgs in #print axioms correct
542:#guard_msgs in #print axioms correct
596:#guard_msgs in #print axioms correct
\end{minted}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \subsection{Full Workflow Example}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% When adding this appendix to your paper, 
% please remove below part
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}

